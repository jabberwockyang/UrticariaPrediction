
SELECT 
    CASE WHEN p.Gender = 'ç”·' THEN 1 ELSE 0 END as Gender,
    p.FirstVisitAge,
    p.VisitDuration,
    p.CIndU,
    AVG(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Hematocrit_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Hematocrit_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Hematocrit_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS PlateletCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PlateletCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PlateletCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Hemoglobin_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Hemoglobin_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Hemoglobin_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Plateletcrit_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Plateletcrit_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Plateletcrit_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS CReactiveProtein_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CReactiveProtein_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CReactiveProtein_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS TotalThyroxine_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TotalThyroxine_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TotalThyroxine_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS FreeThyroxine_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS FreeThyroxine_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS FreeThyroxine_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ANA1to40_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANA1to40_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANA1to40_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ANA1to80_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANA1to80_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANA1to80_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS SMRNP_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS SMRNP_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS SMRNP_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiScl70_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiScl70_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiScl70_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiSSA_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSSA_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSSA_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiSSB_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSSB_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSSB_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiJo1_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiJo1_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiJo1_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiSM_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSM_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiSM_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Nucleosome_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Nucleosome_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Nucleosome_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS AntiM2_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiM2_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS AntiM2_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS PMScl_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PMScl_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PMScl_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Histone_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Histone_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Histone_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS CentromereProteinB_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CentromereProteinB_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CentromereProteinB_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Ro52_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Ro52_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Ro52_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ThrombinTime_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThrombinTime_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ThrombinTime_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ProthrombinTime_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProthrombinTime_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProthrombinTime_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrinepH_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrinepH_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrinepH_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrineGlucose_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineGlucose_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineGlucose_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrineProtein_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineProtein_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineProtein_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS TransparentCylinders_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TransparentCylinders_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TransparentCylinders_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Urobilinogen_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Urobilinogen_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Urobilinogen_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Urobilin_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Urobilin_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Urobilin_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS CellularCasts_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CellularCasts_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CellularCasts_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrineKetones_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineKetones_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineKetones_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS UrineNitrites_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineNitrites_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS UrineNitrites_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS GranularCasts_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS GranularCasts_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS GranularCasts_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Transparency_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Transparency_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Transparency_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Milk_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Milk_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Milk_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Cockroach_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cockroach_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cockroach_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS EggWhite_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EggWhite_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS EggWhite_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS CatDander_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CatDander_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS CatDander_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS DogDander_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS DogDander_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS DogDander_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Ragweed_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Ragweed_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Ragweed_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS RyeGrass_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RyeGrass_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS RyeGrass_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Pineapple_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Pineapple_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Pineapple_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Cod_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cod_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cod_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Shrimp_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Shrimp_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Shrimp_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Beef_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Beef_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Beef_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Mango_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mango_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mango_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Peanut_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Peanut_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Peanut_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Cashew_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cashew_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Cashew_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Lamb_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Lamb_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Lamb_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Soy_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Soy_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Soy_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS HouseDust_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS HouseDust_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS HouseDust_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS DustMites_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS DustMites_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS DustMites_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS LobsterScallop_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS LobsterScallop_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS LobsterScallop_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Shellfish_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Shellfish_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Shellfish_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Amaranth_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Amaranth_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Amaranth_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MoldCombination_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MoldCombination_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MoldCombination_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Mulberry_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mulberry_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mulberry_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS TreePollenCombination_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TreePollenCombination_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS TreePollenCombination_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Crab_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Crab_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Crab_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS MixedGrasses_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MixedGrasses_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS MixedGrasses_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Mugwort_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mugwort_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Mugwort_Avg_chronic,
    AVG(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' AND npe.ExaminationDate < p.FirstVisitDate THEN npe.Result ELSE NULL END) AS Salmon_Avg_preclinical,
    AVG(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' AND npe.ExaminationDate >= p.FirstVisitDate AND npe.ExaminationDate < DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Salmon_Avg_acute,
    AVG(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' AND npe.ExaminationDate >= DATE(p.FirstVisitDate, '+42 days') THEN npe.Result ELSE NULL END) AS Salmon_Avg_chronic
FROM 
    Patients p
LEFT JOIN 
    NewPatientExaminations npe ON p.PatientID = npe.PatientID
WHERE 
    p.VisitDuration > 42
GROUP BY 
    p.PatientID;

