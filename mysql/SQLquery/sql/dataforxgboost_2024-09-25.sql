
SELECT 
    CASE WHEN p.Gender = 'ç”·' THEN 1 ELSE 0 END as Gender,
    p.FirstVisitAge,
    p.VisitDuration,
    p.CIndU,
    AVG(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' THEN npe.Result ELSE NULL END) AS Hematocrit_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' THEN npe.Result ELSE NULL END) AS Hematocrit_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '6278441ef53bf0fff019ded02eff7a21' THEN npe.Result ELSE NULL END) AS Hematocrit_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '1cbd2ffe4f44434033bd25a575f7486a' THEN npe.Result ELSE NULL END) AS LymphocytesPercentage_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd0e2338283638e45fe80e759d602b990' THEN npe.Result ELSE NULL END) AS NeutrophilsPercentage_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '8a693f4998ba94129b3902c33cd130de' THEN npe.Result ELSE NULL END) AS MonocytesPercentage_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b8d85eddf0e8f2ffc7a21c0ec639c145' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobinConcentration_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' THEN npe.Result ELSE NULL END) AS PlateletCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' THEN npe.Result ELSE NULL END) AS PlateletCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'c62631e41aba6daf6b726462146927ef' THEN npe.Result ELSE NULL END) AS PlateletCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '00a6d8b57a9d056a1d8619d5b792912a' THEN npe.Result ELSE NULL END) AS WhiteBloodCellCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b59c0970f72e9b572fb36b53206bc031' THEN npe.Result ELSE NULL END) AS MeanCorpuscularHemoglobin_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '843da842ce0012eb25e13cd61103b733' THEN npe.Result ELSE NULL END) AS MeanCorpuscularVolume_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '67a4a480ec380463594249bab0f2fa0b' THEN npe.Result ELSE NULL END) AS RedBloodCellCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' THEN npe.Result ELSE NULL END) AS Hemoglobin_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' THEN npe.Result ELSE NULL END) AS Hemoglobin_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '34f39f359c1390b63a26ceb8c1148b2f' THEN npe.Result ELSE NULL END) AS Hemoglobin_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '0f8698217b06458bd6e487a73264f5eb' THEN npe.Result ELSE NULL END) AS EosinophilsPercentage_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'fc02506aece624eac8117269d63de64f' THEN npe.Result ELSE NULL END) AS BasophilsPercentage_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '90599d743472eda35f6dda7cf003d78a' THEN npe.Result ELSE NULL END) AS AbsoluteNeutrophilCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '7e34977322830cb9c0e56caeec9bad2e' THEN npe.Result ELSE NULL END) AS AbsoluteMonocyteCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd48ba711365665a5bf03f3b1fb9c3a0a' THEN npe.Result ELSE NULL END) AS AbsoluteEosinophilCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '9a84228a363b4eeb3f6ae538b90012a8' THEN npe.Result ELSE NULL END) AS AbsoluteBasophilCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '8b6ad06d80a84796c919831dcff91264' THEN npe.Result ELSE NULL END) AS AbsoluteLymphocyteCount_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '2db10653f7f4f428d52e0ab6ab8ec50c' THEN npe.Result ELSE NULL END) AS MeanPlateletVolume_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'ca70a37bcbeb48b33463877d5bdc2e00' THEN npe.Result ELSE NULL END) AS PlateletDistributionWidth_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' THEN npe.Result ELSE NULL END) AS Plateletcrit_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' THEN npe.Result ELSE NULL END) AS Plateletcrit_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'fac112b794a7094cbf727f4c02fe9de9' THEN npe.Result ELSE NULL END) AS Plateletcrit_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '68bfb24395d5156bdb77b24607c13771' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidth_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'ffb58a7d383244db32bc85b32b7b8fc6' THEN npe.Result ELSE NULL END) AS RedCellDistributionWidthCV_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '5c079d39af0872182e20042c9f4c0ec0' THEN npe.Result ELSE NULL END) AS EosinophilCountAbsolute_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' THEN npe.Result ELSE NULL END) AS CReactiveProtein_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' THEN npe.Result ELSE NULL END) AS CReactiveProtein_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3b9cb27daef6bb4d226baeca1543a1f1' THEN npe.Result ELSE NULL END) AS CReactiveProtein_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '2e68e1d95f5a26cbef1058d335736258' THEN npe.Result ELSE NULL END) AS ImmunoglobulinE_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '9e56eb5d89a2ec9c8fd759be783cd16e' THEN npe.Result ELSE NULL END) AS Total25HydroxyVitaminD_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '62d50e82e90bd065e5cfee338ff2e49e' THEN npe.Result ELSE NULL END) AS ImmunoglobulinG_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'f05b22960a3ba4613023534e17119973' THEN npe.Result ELSE NULL END) AS ImmunoglobulinA_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'e5e65a981c614000eff913471d5b4b79' THEN npe.Result ELSE NULL END) AS ImmunoglobulinM_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '5c417eaa42a8da64e21049aff7c1de4d' THEN npe.Result ELSE NULL END) AS ThyroglobulinAntibody_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '1a19c55284e9bc9789eafe0c346fe9f2' THEN npe.Result ELSE NULL END) AS ThyroidStimulatingHormone_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'ea6a6b1af8ed51e7da5f98f4819d0ac0' THEN npe.Result ELSE NULL END) AS TotalTriiodothyronine_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' THEN npe.Result ELSE NULL END) AS TotalThyroxine_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' THEN npe.Result ELSE NULL END) AS TotalThyroxine_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '1aaccf6d25d1a05162735e41dcef799f' THEN npe.Result ELSE NULL END) AS TotalThyroxine_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '42442184b920b962bbbf84b65feff9ce' THEN npe.Result ELSE NULL END) AS FreeTriiodothyronine_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' THEN npe.Result ELSE NULL END) AS FreeThyroxine_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' THEN npe.Result ELSE NULL END) AS FreeThyroxine_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'a93cc5a39800eb5810aaaafeed2e892f' THEN npe.Result ELSE NULL END) AS FreeThyroxine_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3463497904a2ee63dc52b5ee63de5fcc' THEN npe.Result ELSE NULL END) AS ReverseTriiodothyronine_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' THEN npe.Result ELSE NULL END) AS ANA1to40_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' THEN npe.Result ELSE NULL END) AS ANA1to40_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b52615c9d3be2eb07b736fdb0dabd240' THEN npe.Result ELSE NULL END) AS ANA1to40_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' THEN npe.Result ELSE NULL END) AS ANA1to80_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' THEN npe.Result ELSE NULL END) AS ANA1to80_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '7c3907d5fc7e101989e4440fddc6d835' THEN npe.Result ELSE NULL END) AS ANA1to80_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3ec664ec2c24e58186851c2bf67c9d00' THEN npe.Result ELSE NULL END) AS ANANuclearPattern_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' THEN npe.Result ELSE NULL END) AS SMRNP_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' THEN npe.Result ELSE NULL END) AS SMRNP_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '80f270bde00817d4efe49f4023ac097e' THEN npe.Result ELSE NULL END) AS SMRNP_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' THEN npe.Result ELSE NULL END) AS AntiScl70_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' THEN npe.Result ELSE NULL END) AS AntiScl70_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '218ef06f82ed288e33aad8fa8ff943b8' THEN npe.Result ELSE NULL END) AS AntiScl70_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' THEN npe.Result ELSE NULL END) AS AntiSSA_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' THEN npe.Result ELSE NULL END) AS AntiSSA_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '88e792cf928112a271bc1fac921f5e84' THEN npe.Result ELSE NULL END) AS AntiSSA_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' THEN npe.Result ELSE NULL END) AS AntiSSB_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' THEN npe.Result ELSE NULL END) AS AntiSSB_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '2fea0e1b06d0d646ee529fb2f6d2e982' THEN npe.Result ELSE NULL END) AS AntiSSB_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' THEN npe.Result ELSE NULL END) AS AntiJo1_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' THEN npe.Result ELSE NULL END) AS AntiJo1_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '02a97a40f6649a9d76dd0c623381d17d' THEN npe.Result ELSE NULL END) AS AntiJo1_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '120f5a1751f405ab3fb67cac843addeb' THEN npe.Result ELSE NULL END) AS AntiDoubleStrandedDNA_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' THEN npe.Result ELSE NULL END) AS AntiSM_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' THEN npe.Result ELSE NULL END) AS AntiSM_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '831345e8b1c4d6cd98781b1a841db0a0' THEN npe.Result ELSE NULL END) AS AntiSM_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' THEN npe.Result ELSE NULL END) AS Nucleosome_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' THEN npe.Result ELSE NULL END) AS Nucleosome_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'cbbf953ed60e1e7fbbd366018dcd0335' THEN npe.Result ELSE NULL END) AS Nucleosome_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' THEN npe.Result ELSE NULL END) AS AntiM2_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' THEN npe.Result ELSE NULL END) AS AntiM2_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '80ae7b3716e53cad7fce522a19d584c9' THEN npe.Result ELSE NULL END) AS AntiM2_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3e6a623cf1612b069bd5a29e5d3a04ff' THEN npe.Result ELSE NULL END) AS ProliferatingCellNuclearAntigen_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'c7efc8e928e45a09e5107a3d4aa30235' THEN npe.Result ELSE NULL END) AS RibosomalPProtein_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' THEN npe.Result ELSE NULL END) AS PMScl_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' THEN npe.Result ELSE NULL END) AS PMScl_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '0c3a4b82e102858676ce6b9f2e9fd095' THEN npe.Result ELSE NULL END) AS PMScl_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' THEN npe.Result ELSE NULL END) AS Histone_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' THEN npe.Result ELSE NULL END) AS Histone_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '2c98bf4064a1fbc43da99c7f510ac6ef' THEN npe.Result ELSE NULL END) AS Histone_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' THEN npe.Result ELSE NULL END) AS CentromereProteinB_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' THEN npe.Result ELSE NULL END) AS CentromereProteinB_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3c46d27c40d67fd9dae80c739817f548' THEN npe.Result ELSE NULL END) AS CentromereProteinB_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' THEN npe.Result ELSE NULL END) AS Ro52_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' THEN npe.Result ELSE NULL END) AS Ro52_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3c51bb00f98835aa68f8adee2ba8c346' THEN npe.Result ELSE NULL END) AS Ro52_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' THEN npe.Result ELSE NULL END) AS ThrombinTime_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' THEN npe.Result ELSE NULL END) AS ThrombinTime_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '7f7e0ee369bef57e8f61e30c1e7c66dc' THEN npe.Result ELSE NULL END) AS ThrombinTime_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'c80ee1e21043caf514d5490648c402c1' THEN npe.Result ELSE NULL END) AS PartialThromboplastinTime_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' THEN npe.Result ELSE NULL END) AS ProthrombinTime_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' THEN npe.Result ELSE NULL END) AS ProthrombinTime_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'cf2ffd6184e1fb52eb18e2af3058c699' THEN npe.Result ELSE NULL END) AS ProthrombinTime_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'faf5ba201852f48eaa5448534a83f919' THEN npe.Result ELSE NULL END) AS ProthrombinTimeINR_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' THEN npe.Result ELSE NULL END) AS UrinepH_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' THEN npe.Result ELSE NULL END) AS UrinepH_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '77e16499e81a2400b1079c143143d179' THEN npe.Result ELSE NULL END) AS UrinepH_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' THEN npe.Result ELSE NULL END) AS UrineGlucose_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' THEN npe.Result ELSE NULL END) AS UrineGlucose_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '439fb10bc94c44048baa278a798c7161' THEN npe.Result ELSE NULL END) AS UrineGlucose_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' THEN npe.Result ELSE NULL END) AS UrineProtein_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' THEN npe.Result ELSE NULL END) AS UrineProtein_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '7711877dbd0c2379fe960e9b5298b25e' THEN npe.Result ELSE NULL END) AS UrineProtein_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' THEN npe.Result ELSE NULL END) AS TransparentCylinders_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' THEN npe.Result ELSE NULL END) AS TransparentCylinders_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd06278465bbd6a4990869cb9e65eb76d' THEN npe.Result ELSE NULL END) AS TransparentCylinders_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' THEN npe.Result ELSE NULL END) AS Urobilinogen_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' THEN npe.Result ELSE NULL END) AS Urobilinogen_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '401bb582bc8181d43e6339de9825c538' THEN npe.Result ELSE NULL END) AS Urobilinogen_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'a4c8f4a96616539ad0dad396de4ed3d7' THEN npe.Result ELSE NULL END) AS UrineSpecificGravity_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' THEN npe.Result ELSE NULL END) AS Urobilin_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' THEN npe.Result ELSE NULL END) AS Urobilin_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'ace16ff416a176b12d4cfaf897051cb7' THEN npe.Result ELSE NULL END) AS Urobilin_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '4107005ddfe410783b52fb2df00b5f31' THEN npe.Result ELSE NULL END) AS RedBloodCellsMicroscopic_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'c4da78a55dab6f5f83f320d4770e90d5' THEN npe.Result ELSE NULL END) AS EpithelialCellsMicroscopic_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' THEN npe.Result ELSE NULL END) AS CellularCasts_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' THEN npe.Result ELSE NULL END) AS CellularCasts_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '244e9182d4c483ff3890695af81290b8' THEN npe.Result ELSE NULL END) AS CellularCasts_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' THEN npe.Result ELSE NULL END) AS UrineKetones_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' THEN npe.Result ELSE NULL END) AS UrineKetones_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '88991347a1602cfa51b925d2cf59f291' THEN npe.Result ELSE NULL END) AS UrineKetones_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' THEN npe.Result ELSE NULL END) AS UrineNitrites_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' THEN npe.Result ELSE NULL END) AS UrineNitrites_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd422c59b80b488bf0d3eb395877118f4' THEN npe.Result ELSE NULL END) AS UrineNitrites_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' THEN npe.Result ELSE NULL END) AS GranularCasts_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' THEN npe.Result ELSE NULL END) AS GranularCasts_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd09eb12be2f8c5a98409f010be91f395' THEN npe.Result ELSE NULL END) AS GranularCasts_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' THEN npe.Result ELSE NULL END) AS Transparency_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' THEN npe.Result ELSE NULL END) AS Transparency_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '01f1a2dfccb24975181894eca2664bbb' THEN npe.Result ELSE NULL END) AS Transparency_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b2857502dc2b4916c0dd2f33f867f4d1' THEN npe.Result ELSE NULL END) AS WhiteBloodCellsMicroscopic_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' THEN npe.Result ELSE NULL END) AS Milk_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' THEN npe.Result ELSE NULL END) AS Milk_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '9a7c46f7810320682427340e1d2f1c92' THEN npe.Result ELSE NULL END) AS Milk_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' THEN npe.Result ELSE NULL END) AS Cockroach_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' THEN npe.Result ELSE NULL END) AS Cockroach_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3690f4ef561fdf45c209e21ead765cb5' THEN npe.Result ELSE NULL END) AS Cockroach_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' THEN npe.Result ELSE NULL END) AS EggWhite_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' THEN npe.Result ELSE NULL END) AS EggWhite_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '9731b89f34bb7ac736e2ed8c7cec1491' THEN npe.Result ELSE NULL END) AS EggWhite_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' THEN npe.Result ELSE NULL END) AS CatDander_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' THEN npe.Result ELSE NULL END) AS CatDander_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '3ad3abcf70205140f3901f95f23c8486' THEN npe.Result ELSE NULL END) AS CatDander_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' THEN npe.Result ELSE NULL END) AS DogDander_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' THEN npe.Result ELSE NULL END) AS DogDander_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'eebf1677cd9199f413460e8f12a31791' THEN npe.Result ELSE NULL END) AS DogDander_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' THEN npe.Result ELSE NULL END) AS Ragweed_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' THEN npe.Result ELSE NULL END) AS Ragweed_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b393748f0c6fe24d354b8fca68d5f747' THEN npe.Result ELSE NULL END) AS Ragweed_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' THEN npe.Result ELSE NULL END) AS RyeGrass_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' THEN npe.Result ELSE NULL END) AS RyeGrass_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'ded80258ccb99af7e3ff94ffae9e8b67' THEN npe.Result ELSE NULL END) AS RyeGrass_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' THEN npe.Result ELSE NULL END) AS Pineapple_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' THEN npe.Result ELSE NULL END) AS Pineapple_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '13078e395d1805b0e525d4402d7c86bf' THEN npe.Result ELSE NULL END) AS Pineapple_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' THEN npe.Result ELSE NULL END) AS Cod_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' THEN npe.Result ELSE NULL END) AS Cod_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '4dd892a805af4f0eb8ac0915662aeff0' THEN npe.Result ELSE NULL END) AS Cod_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' THEN npe.Result ELSE NULL END) AS Shrimp_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' THEN npe.Result ELSE NULL END) AS Shrimp_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '5d481a1fe87606c94d68a4dc7bb25938' THEN npe.Result ELSE NULL END) AS Shrimp_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' THEN npe.Result ELSE NULL END) AS Beef_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' THEN npe.Result ELSE NULL END) AS Beef_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'c004491659201be7e30935799682d43c' THEN npe.Result ELSE NULL END) AS Beef_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' THEN npe.Result ELSE NULL END) AS Mango_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' THEN npe.Result ELSE NULL END) AS Mango_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'e899d2386b88ebd76eab331b12fd89b9' THEN npe.Result ELSE NULL END) AS Mango_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' THEN npe.Result ELSE NULL END) AS Peanut_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' THEN npe.Result ELSE NULL END) AS Peanut_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '59420a94e594288e04acd171411132c4' THEN npe.Result ELSE NULL END) AS Peanut_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' THEN npe.Result ELSE NULL END) AS Cashew_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' THEN npe.Result ELSE NULL END) AS Cashew_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '8e00432871a5d3e6f4f7d1e4d6586ecb' THEN npe.Result ELSE NULL END) AS Cashew_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' THEN npe.Result ELSE NULL END) AS Lamb_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' THEN npe.Result ELSE NULL END) AS Lamb_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'fd4a808e8cfadf5975ccae2781bd1eae' THEN npe.Result ELSE NULL END) AS Lamb_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' THEN npe.Result ELSE NULL END) AS Soy_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' THEN npe.Result ELSE NULL END) AS Soy_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '097e92bd23c05fbf6c8f781f77826940' THEN npe.Result ELSE NULL END) AS Soy_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' THEN npe.Result ELSE NULL END) AS HouseDust_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' THEN npe.Result ELSE NULL END) AS HouseDust_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'fefed6fdceed593e3552716e98e959b7' THEN npe.Result ELSE NULL END) AS HouseDust_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' THEN npe.Result ELSE NULL END) AS DustMites_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' THEN npe.Result ELSE NULL END) AS DustMites_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '9c13da1543babeaccc8dc1b81908db99' THEN npe.Result ELSE NULL END) AS DustMites_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' THEN npe.Result ELSE NULL END) AS LobsterScallop_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' THEN npe.Result ELSE NULL END) AS LobsterScallop_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'e809e11e9a698607a73e3925a6bfe780' THEN npe.Result ELSE NULL END) AS LobsterScallop_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' THEN npe.Result ELSE NULL END) AS Shellfish_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' THEN npe.Result ELSE NULL END) AS Shellfish_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '93d5b9cffed205327aa7aa7654d8e86a' THEN npe.Result ELSE NULL END) AS Shellfish_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' THEN npe.Result ELSE NULL END) AS Amaranth_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' THEN npe.Result ELSE NULL END) AS Amaranth_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '62740ace5637ed3c205fb71c5d8c7340' THEN npe.Result ELSE NULL END) AS Amaranth_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' THEN npe.Result ELSE NULL END) AS MoldCombination_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' THEN npe.Result ELSE NULL END) AS MoldCombination_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'e4d54d879b2b3c541d6d47b81d275236' THEN npe.Result ELSE NULL END) AS MoldCombination_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' THEN npe.Result ELSE NULL END) AS Mulberry_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' THEN npe.Result ELSE NULL END) AS Mulberry_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '4b7801fc5d1f5f4ea5c57c97dee6c3b8' THEN npe.Result ELSE NULL END) AS Mulberry_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' THEN npe.Result ELSE NULL END) AS TreePollenCombination_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' THEN npe.Result ELSE NULL END) AS TreePollenCombination_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'e9b0eaa0ccb7f15b57b384a4b3dce53b' THEN npe.Result ELSE NULL END) AS TreePollenCombination_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' THEN npe.Result ELSE NULL END) AS Crab_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' THEN npe.Result ELSE NULL END) AS Crab_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'b0a346e1eb91a39e39f98b168b1daf53' THEN npe.Result ELSE NULL END) AS Crab_Min,
    AVG(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' THEN npe.Result ELSE NULL END) AS MixedGrasses_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' THEN npe.Result ELSE NULL END) AS MixedGrasses_Max,
    MIN(CASE WHEN npe.ExaminationItemID = 'd6d832174b389b3de83af7b2f0c93ed5' THEN npe.Result ELSE NULL END) AS MixedGrasses_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' THEN npe.Result ELSE NULL END) AS Mugwort_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' THEN npe.Result ELSE NULL END) AS Mugwort_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '5151a6b5fac9eeec6188a532fb2228c3' THEN npe.Result ELSE NULL END) AS Mugwort_Min,
    AVG(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' THEN npe.Result ELSE NULL END) AS Salmon_Avg,
    MAX(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' THEN npe.Result ELSE NULL END) AS Salmon_Max,
    MIN(CASE WHEN npe.ExaminationItemID = '684ba7942c51e6fe176495ee641b8e98' THEN npe.Result ELSE NULL END) AS Salmon_Min
FROM 
    Patients p
LEFT JOIN 
    NewPatientExaminations npe ON p.PatientID = npe.PatientID
WHERE 
    p.TotalVisits > 2
GROUP BY 
    p.PatientID;

